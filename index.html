<head>
    <script src='https://statics.teams.cdn.office.net/sdk/v1.6.0/js/MicrosoftTeams.min.js'></script>
    <script src="https://unpkg.com/adaptivecards-templating@1.4.0/dist/adaptivecards-templating.js"></script>
    <script src="https://unpkg.com/adaptivecards/dist/adaptivecards.min.js"></script>
</head>
<body>
    <script>
        /*microsoftTeams.initialize();
        microsoftTeams.settings.registerOnSaveHandler((saveEvent) => {
            microsoftTeams.settings.setSettings({
                    websiteUrl: "https://jensehrhardt-eopus.github.io/Mittagsbot/",
                    contentUrl: "https://jensehrhardt-eopus.github.io/Mittagsbot/",
                    entityId: "grayIconTab",
                    suggestedDisplayName: "MyNewTab"
                });
            saveEvent.notifySuccess();
        });
        microsoftTeams.settings.setValidityState(true);*/
        
        fetch('https://shop.meyer-menue.de/api/v1/menue/MDI5ODM3/year/2021/week/47')
            .then(response => response.json())
            .then(data => 
                {
                    var adaptiveCard = new AdaptiveCards.AdaptiveCard();
                    adaptiveCard.parse(new ACData.Template({
                        "type": "AdaptiveCard",
                        "version": "1.0",
                        "$data": {
                            "menu": data
                        },
                        "body": [
                            {
                                "type": "Container",
                                "$data": data,
                                "items": [ 
                                    {
                                        "type": "Image",
                                        "url": "https://shop.meyer-menue.de/assets/image/${menuimage}"
                                    },
                                    {
                                        "type": "TextBlock",
                                        "text": "Hello ${title}"
                                    }
                                ]
                            }
                        ],
                        "actions": [
                            {
                                "type": "Action.OpenUrl",
                                "title": "Learn more",
                                "url": "http://adaptivecards.io"
                            },
                            {
                                "type": "Action.OpenUrl",
                                "title": "GitHub",
                                "url": "http://github.com/Microsoft/AdaptiveCards"
                            }
                        ]
                    }).expand({$root:{}}));
                    document.body.appendChild(adaptiveCard.render());
                });
    </script>
    Hiho
</body>
